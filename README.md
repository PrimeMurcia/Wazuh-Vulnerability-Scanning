# Vulnerability Detection with Wazuh

## Use Case Overview
Wazuh's Vulnerability Detector module identifies vulnerabilities in applications and operating systems running on endpoints. This use case demonstrates how Wazuh detects unpatched Common Vulnerabilities and Exposures (CVEs) on monitored Ubuntu 22.04 endpoints.

For more information, refer to the [vulnerability detection section](https://documentation.wazuh.com/current/user-manual/capabilities/vulnerability-detection/index.html) of the Wazuh documentation.

## Infrastructure

- **Endpoint**:
  - **Ubuntu 22.04**: The vulnerability detection module scans this Linux endpoint for vulnerabilities in its operating system and installed applications.

## Configuration

Perform the following steps on the Wazuh server to enable the Vulnerability Detector module:

1. **Enable the Vulnerability Detector module in the `/var/ossec/etc/ossec.conf` file**:

```xml
<ossec_config>
  <vulnerability-detector>
    <enabled>yes</enabled>
    <interval>5m</interval>
    <min_full_scan_interval>6h</min_full_scan_interval>
    <run_on_start>yes</run_on_start>

    <!-- Ubuntu OS vulnerabilities -->
    <provider name="canonical">
      <enabled>yes</enabled>
      <os>trusty</os>
      <os>xenial</os>
      <os>bionic</os>
      <os>focal</os>
      <os>jammy</os>
      <update_interval>1h</update_interval>
    </provider>

    <!-- Debian OS vulnerabilities -->
    <provider name="debian">
      <enabled>yes</enabled>
      <os>buster</os>
      <os>bullseye</os>
      <os>bookworm</os>
      <update_interval>1h</update_interval>
    </provider>

    <!-- RedHat OS vulnerabilities -->
    <provider name="redhat">
      <enabled>yes</enabled>
      <os>5</os>
      <os>6</os>
      <os>7</os>
      <os>8</os>
      <os allow="CentOS Linux-8">8</os>
      <os>9</os>
      <update_interval>1h</update_interval>
    </provider>

    <!-- Windows OS vulnerabilities -->
    <provider name="msu">
      <enabled>yes</enabled>
      <update_interval>1h</update_interval>
    </provider>

    <!-- Aggregate vulnerabilities -->
    <provider name="nvd">
      <enabled>yes</enabled>
      <update_interval>1h</update_interval>
    </provider>
  </vulnerability-detector>
</ossec_config>
```
2. **Restart the Wazuh manager to apply the configuration changes:**
```bash
sudo systemctl restart wazuh-manager
```

### Expected Outcome
##### Once configured, the Wazuh Vulnerability Detector module will periodically scan the specified Ubuntu and Windows endpoints for known vulnerabilities. It will detect unpatched CVEs and provide alerts to help administrators mitigate security risks promptly.

### Additional Resources

Wazuh Documentation: [Vulnerability Detector](https://documentation.wazuh.com/current/user-manual/capabilities/vulnerability-detection/index.html)
[Wazuh](https://wazuh.com/)


##### By following these steps, you can leverage Wazuh to maintain a robust security posture by ensuring that vulnerabilities in your endpoints are promptly detected and addressed.
